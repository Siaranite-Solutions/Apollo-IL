using System;
using Apollo_IL;
using System.IO;

namespace AIL_Runtime
{
    class Program
    {
        public static byte[] HelloWorldHex =
        {
            0x41, 0xf5, 0x02, 0x00, 0x00, 0x00, 0x41, 0xfd, 0xfa, 0x00, 0x00, 0x00,
            0xfa, 0x45, 0xfa, 0x00, 0x00, 0x00, 0xfa, 0x6e, 0xfb, 0x00, 0x00, 0x00,
            0xfa, 0x74, 0xfc, 0x00, 0x00, 0x00, 0xfa, 0x65, 0xfd, 0x00, 0x00, 0x00,
            0xfa, 0x72, 0xfe, 0x00, 0x00, 0x00, 0xfa, 0xff, 0x00, 0x00, 0x00, 0xfa,
            0x59, 0x00, 0x01, 0x00, 0x00, 0xfa, 0x6f, 0x01, 0x01, 0x00, 0x00, 0xfa,
            0x75, 0x02, 0x01, 0x00, 0x00, 0xfa, 0x72, 0x03, 0x01, 0x00, 0x00, 0xfa,
            0x04, 0x01, 0x00, 0x00, 0xfa, 0x4e, 0x05, 0x01, 0x00, 0x00, 0xfa, 0x61,
            0x06, 0x01, 0x00, 0x00, 0xfa, 0x6d, 0x07, 0x01, 0x00, 0x00, 0xfa, 0x65,
            0x08, 0x01, 0x00, 0x00, 0xfa, 0x3a, 0x01, 0x00, 0x00, 0xfa, 0x01, 0x00,
            0x00, 0x41, 0xf7, 0x11, 0x00, 0x00, 0x00, 0xeb, 0x01, 0x00, 0x00, 0x00,
            0x00, 0x41, 0xf5, 0x04, 0x00, 0x00, 0x00, 0x41, 0xfd, 0xf4, 0x01, 0x00,
            0x00, 0xeb, 0x01, 0x00, 0x00, 0x00, 0x00, 0xfa, 0x48, 0xed, 0x01, 0x00,
            0x00, 0xfa, 0x65, 0xee, 0x01, 0x00, 0x00, 0xfa, 0x6c, 0xef, 0x01, 0x00,
            0x00, 0xfa, 0x6c, 0xf0, 0x01, 0x00, 0x00, 0xfa, 0x6f, 0xf1, 0x01, 0x00,
            0x00, 0xfa, 0x2c, 0xf2, 0x01, 0x00, 0x00, 0xfa, 0xf3, 0x01, 0x00, 0x00,
            0x41, 0xfd, 0xed, 0x01, 0x00, 0x00, 0x44, 0xf7, 0x07, 0x00, 0x00, 0x00,
            0x41, 0xf5, 0x02, 0x00, 0x00, 0x00, 0xeb, 0x01, 0x00, 0x00, 0x00, 0x00,
            0x41, 0xf5, 0x01, 0x00, 0x00, 0x00, 0x41, 0xf6, 0x00, 0x00, 0x00, 0xeb,
            0x01, 0x00, 0x00, 0x00, 0x00, 0xd0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
        };

        public static byte[] HelloWorld =
        {
            065, 245, 002, 000, 000, 000, 065, 253, 250, 000, 000, 000,
            250, 069, 250, 000, 000, 000, 250, 110, 251, 000, 000, 000,
            250, 116, 252, 000, 000, 000, 250, 101, 253, 000, 000, 000,
            250, 114, 254, 000, 000, 000, 250, 255, 000, 000, 000, 250,
            089, 000, 001, 000, 000, 250, 111, 001, 001, 000, 000, 250,
            117, 002, 001, 000, 000, 250, 114, 003, 001, 000, 000, 250,
            004, 001, 000, 000, 250, 078, 005, 001, 000, 000, 250, 097,
            006, 001, 000, 000, 250, 109, 007, 001, 000, 000, 250, 101,
            008, 001, 000, 000, 250, 058, 001, 000, 000, 250, 001, 000,
            000, 065, 247, 017, 000, 000, 000, 235, 001, 000, 000, 000,
            000, 065, 245, 004, 000, 000, 000, 065, 253, 244, 001, 000,
            000, 235, 001, 000, 000, 000, 000, 250, 072, 237, 001, 000,
            000, 250, 101, 238, 001, 000, 000, 250, 108, 239, 001, 000,
            000, 250, 108, 240, 001, 000, 000, 250, 111, 241, 001, 000,
            000, 250, 044, 242, 001, 000, 000, 250, 243, 001, 000, 000,
            065, 253, 237, 001, 000, 000, 068, 247, 007, 000, 000, 000,
            065, 245, 002, 000, 000, 000, 235, 001, 000, 000, 000, 000,
            065, 245, 001, 000, 000, 000, 065, 246, 000, 000, 000, 235,
            001, 000, 000, 000, 000, 208, 000, 000, 000, 000, 000, 000
        };

        static void Main(string[] args)
        {
            byte[] LoadedApplication = null;
            Apollo_IL.Globals.console = new AIL_Runtime.AR_Console();
            if (args.Length == 0)
            {
                Console.Title = "Apollo-VM Runtime - Hello World!";
                LoadedApplication = HelloWorld;
                
            }
            else
            {
                LoadedApplication = File.ReadAllBytes(args[0]);
            }
            try
            {
                Apollo_IL.Executable.Run(LoadedApplication);
            }
            catch (Exception ex)
            {
                Console.ForegroundColor = ConsoleColor.Red;
                Console.WriteLine(ex.Message + "\nPress any key to terminate...");
                Console.ReadKey(true);
            }
        }
    }
}
